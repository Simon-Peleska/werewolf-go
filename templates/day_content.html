<div class="game-content" id="game-content" hx-swap="innerHTML" hx-swap-oob="true">
    <section>
        <h2 id="phase-heading"><span id="day">Day</span> {{.NightNumber}}</h2>

        {{if .NightVictims}}
        <div class="death-announcement" id="death-announcement">
            {{range .NightVictims}}
            <p><strong>{{.Name}}</strong> was found dead this morning. They were a <strong>{{.Role}}</strong>.</p>
            {{end}}
        </div>
        {{else}}
        <p id="no-death-message">The village awakens. No one died last night.</p>
        {{end}}

        {{if .HunterRevengeNeeded}}
        <div id="hunter-revenge-section">
            {{if .HunterRevengeDone}}
            <div class="death-announcement" id="hunter-revenge-result">
                <p>The Hunter's last shot killed <strong>{{.HunterVictim}}</strong>!</p>
                <p>They were a <strong>{{.HunterVictimRole}}</strong>.</p>
            </div>
            {{else if .IsTheHunter}}
            <h3>üèπ Your Last Shot</h3>
            <p><small>You have been eliminated! Choose a player to take down with you.</small></p>
            {{range .HunterTargets}}
            <form ws-send id="hunter-form-{{.PlayerID}}" class="vote-form">
                <input type="hidden" name="action" value="hunter_revenge">
                <input type="hidden" name="target_player_id" value="{{.PlayerID}}">
                <button type="submit" id="hunter-btn-{{.PlayerID}}" class="hunter-button">
                    {{.Name}}
                </button>
            </form>
            {{end}}
            {{else}}
            <p id="hunter-waiting"><em>The Hunter is choosing their final target...</em></p>
            {{end}}
        </div>
        {{end}}
    </section>

    {{if not .HunterRevengeNeeded | or .HunterRevengeDone}}
    <section>
        <h3>Vote to Eliminate</h3>
        {{if .IsAlive}}
        <p><small>Choose a player to eliminate, or pass. Majority vote required. When everyone has acted, end the vote.</small></p>

        {{$currentVote := .CurrentVote}}
        {{$hasVoted := .HasVoted}}
        {{range .AliveTargets}}
        <form ws-send id="day-vote-form-{{.PlayerID}}" class="vote-form">
            <input type="hidden" name="action" value="day_vote">
            <input type="hidden" name="target_player_id" value="{{.PlayerID}}">
            <button type="submit" id="day-vote-btn-{{.PlayerID}}" class="vote-button{{if eq $currentVote .PlayerID}} selected{{end}}">
                {{.Name}}
            </button>
        </form>
        {{end}}
        <form ws-send id="day-pass-form" class="vote-form">
            <input type="hidden" name="action" value="day_pass">
            <button type="submit" id="day-pass-btn" class="vote-button{{if and $hasVoted (eq $currentVote 0)}} selected{{end}}">
                Pass
            </button>
        </form>

        {{if .AllActed}}
        <form ws-send id="day-end-vote-form">
            <input type="hidden" name="action" value="day_end_vote">
            <button type="submit" id="day-end-vote-btn" class="contrast">End Vote</button>
        </form>
        {{else}}
        <p id="day-end-vote-waiting"><small><em>Waiting for all players to vote or pass...</em></small></p>
        {{end}}

        {{else}}
        <p><em>You are dead and cannot vote.</em></p>
        {{end}}

        {{if .Votes}}
        <h3>Current Votes</h3>
        <ul id="day-vote-list" class="vote-list">
            {{range .Votes}}
            <li>{{.VoterName}} voted for {{if .TargetName}}{{.TargetName}}{{else}}<em>Pass</em>{{end}}</li>
            {{end}}
        </ul>
        {{end}}
    </section>
    {{end}}
</div>
