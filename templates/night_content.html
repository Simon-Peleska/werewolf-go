<div id="game-content" hx-swap-oob="true">
    <section>
        <h2>Night {{.NightNumber}}</h2>

        {{if .IsWerewolf}}
        <p>The werewolves awaken...</p>

        <h3>Your Pack</h3>
        <ul class="player-list">
            {{range .Werewolves}}
            <li class="werewolf-player">üê∫ {{.Name}}</li>
            {{end}}
        </ul>

        <h3>Choose a Victim</h3>
        <p><small>Select a player to kill. All werewolves must vote.</small></p>

        {{$currentVote := .CurrentVote}}
        {{range .AliveTargets}}
        <form ws-send id="vote-form-{{.PlayerID}}" class="vote-form">
            <input type="hidden" name="action" value="werewolf_vote">
            <input type="hidden" name="target_player_id" value="{{.PlayerID}}">
            <button type="submit" id="vote-btn-{{.PlayerID}}" class="vote-button{{if eq $currentVote .PlayerID}} selected{{end}}">
                {{.Name}}
                {{if eq .Team "werewolf"}} üê∫{{end}}
            </button>
        </form>
        {{end}}

        {{if .Votes}}
        <h3>Current Votes</h3>
        <ul class="vote-list">
            {{range .Votes}}
            <li>{{.VoterName}} ‚Üí {{if .TargetName}}{{.TargetName}}{{else}}<em>undecided</em>{{end}}</li>
            {{end}}
        </ul>
        {{end}}

        {{else if .IsSeer}}
        <h3>üîÆ Your Investigation</h3>
        {{if .HasInvestigated}}
        <p><em>You have already investigated tonight.</em></p>
        {{if .SeerResults}}
        {{range .SeerResults}}
        <p id="seer-result">
            <strong>{{.TargetName}}</strong> is
            {{if .IsWerewolf}}<strong class="seer-werewolf">a Werewolf!</strong>{{else}}<span class="seer-safe">Not a Werewolf</span>{{end}}
        </p>
        {{end}}
        {{end}}
        {{else}}
        <p><small>Choose a player to investigate. You will learn if they are a werewolf.</small></p>
        {{range .AliveTargets}}
        <form ws-send id="seer-form-{{.PlayerID}}" class="vote-form">
            <input type="hidden" name="action" value="seer_investigate">
            <input type="hidden" name="target_player_id" value="{{.PlayerID}}">
            <button type="submit" id="seer-btn-{{.PlayerID}}" class="seer-button">
                {{.Name}}
            </button>
        </form>
        {{end}}
        {{end}}

        {{else if .IsDoctor}}
        <h3>üè• Your Protection</h3>
        {{if .HasProtected}}
        <p id="doctor-result"><em>You are protecting <strong>{{.DoctorProtecting}}</strong> tonight.</em></p>
        {{else}}
        <p><small>Choose a player to protect from the werewolves tonight.</small></p>
        {{range .AliveTargets}}
        <form ws-send id="doctor-form-{{.PlayerID}}" class="vote-form">
            <input type="hidden" name="action" value="doctor_protect">
            <input type="hidden" name="target_player_id" value="{{.PlayerID}}">
            <button type="submit" id="doctor-btn-{{.PlayerID}}" class="doctor-button">
                {{.Name}}
            </button>
        </form>
        {{end}}
        {{end}}

        {{else if .IsGuard}}
        <h3>üõ°Ô∏è Your Protection</h3>
        {{if .GuardHasProtected}}
        <p id="guard-result"><em>You are protecting <strong>{{.GuardProtecting}}</strong> tonight.</em></p>
        {{else}}
        <p><small>Choose a player to protect from the werewolves tonight. You cannot protect yourself or the same player two nights in a row.</small></p>
        {{range .GuardTargets}}
        <form ws-send id="guard-form-{{.PlayerID}}" class="vote-form">
            <input type="hidden" name="action" value="guard_protect">
            <input type="hidden" name="target_player_id" value="{{.PlayerID}}">
            <button type="submit" id="guard-btn-{{.PlayerID}}" class="guard-button">
                {{.Name}}
            </button>
        </form>
        {{end}}
        {{end}}

        {{else}}
        <p>The village sleeps...</p>
        <p>Close your eyes and wait for morning.</p>
        {{end}}
    </section>

    <section>
        <h3>All Players</h3>
        <ul class="player-list">
            {{range .Players}}
            <li class="{{if not .IsAlive}}dead-player{{end}}">
                {{.Name}}
                {{if not .IsAlive}}üíÄ{{end}}
            </li>
            {{end}}
        </ul>
    </section>
</div>
